<!DOCTYPE html>

<html>

<head>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

	<script src="./guitar.js" charset="utf-8"></script>
</head>


<style>
	body {
		background-color: #E0E4CC;
	}

	#controlPanel {
		position: fixed;
		bottom: 0;
		left: 0;
		
		padding: 5px;
		
		background-color: #EDC951;

		font-size: 10px;
	}
</style>



<body>

	<div id="d3container"></div>


	<!-- CONTROL PANEL -->

	<div id="controlPanel">
		<p>
		  <label for="data_radius">
				 circleRadius:
		  </label>
		  <input type="number" min="1" id="data_radius">
		</p>

		<p>
		  <label for="notesAlpha">
				 notes alpha(%):
		  </label>
		  <input type="range" min="1" max="100" id="notesAlpha">
		</p>

		<p>
		  <label for="linesAlpha">
				 lines alpha(%):
		  </label>
		  <input type="range" min="1" max="100" id="linesAlpha">
		</p>

		<p>
		  <input type="checkbox" id="showImage" checked> 
		  <label for="showImage">
				 showImage
		  </label>
		</p>
	</div>

	<script type="text/javascript">

	//////////
	// DATA //
	//////////

	var notesMatrix = [];
	for(var i=0; i<nfrets; i++) {
		notesMatrix[i] = new Array(nstrings);
		for(var j=0; j<nstrings; j++) {
	        notesMatrix[i][j] = 0;
	    }
	}

	var notes = [

		{note:"A", x: 7, y: 4}, {note:"C", x: 5, y: 3}, {note:"E", x: 5, y: 2}, {note:"F", x: 6, y: 2}, {note:"E", x: 5, y: 2}, {note:"D", x: 7, y: 3}, {note:"F", x: 6, y: 2}, {note:"A", x: 5, y: 1}, {note:"A", x: 7, y: 4}, {note:"C", x: 5, y: 3}, {note:"E", x: 5, y: 2}, {note:"F", x: 6, y: 2}, {note:"E", x: 5, y: 2}, {note:"D", x: 7, y: 3}, {note:"F", x: 6, y: 2}, {note:"A", x: 5, y: 1}, {note:"A", x: 7, y: 4}, {note:"C", x: 5, y: 3}, {note:"E", x: 5, y: 2}, {note:"F", x: 6, y: 2}, {note:"E", x: 5, y: 2}, {note:"D", x: 7, y: 3}, {note:"F", x: 6, y: 2}, {note:"A", x: 5, y: 1}, {note:"A", x: 7, y: 4}, {note:"C", x: 5, y: 3}, {note:"E", x: 5, y: 2}, {note:"F", x: 6, y: 2}, {note:"E", x: 5, y: 2}, {note:"D", x: 7, y: 3}, {note:"F", x: 6, y: 2}, {note:"A", x: 5, y: 1}, {note:"A", x: 7, y: 4}, {note:"C", x: 5, y: 3}, {note:"E", x: 5, y: 2}, {note:"F", x: 6, y: 2}, {note:"E", x: 5, y: 2}, {note:"D", x: 7, y: 3}, {note:"F", x: 6, y: 2}, {note:"A", x: 5, y: 1}, {note:"A", x: 7, y: 4}, {note:"C", x: 5, y: 3}, {note:"E", x: 5, y: 2}, {note:"F", x: 6, y: 2}, {note:"E", x: 5, y: 2}, {note:"D", x: 7, y: 3}, {note:"F", x: 6, y: 2}, {note:"A", x: 5, y: 1}, {note:"C", x: 8, y: 1}, {note:"F", x: 6, y: 2}, {note:"D", x: 7, y: 3}, {note:"G", x: 6, y: 4}, {note:"C", x: 8, y: 1}, {note:"F", x: 6, y: 2}, {note:"D", x: 7, y: 3}, {note:"G", x: 6, y: 4}, {note:"C", x: 8, y: 1}, {note:"F", x: 6, y: 2}, {note:"D", x: 7, y: 3}, {note:"G", x: 6, y: 4}, {note:"C", x: 8, y: 1}, {note:"F", x: 6, y: 2}, {note:"D", x: 7, y: 3}, {note:"G", x: 6, y: 4}, {note:"B", x: 7, y: 1}, {note:"F", x: 6, y: 2}, {note:"D", x: 7, y: 3}, {note:"G", x: 6, y: 4}, {note:"A", x: 5, y: 1}, {note:"E", x: 5, y: 2}, {note:"C", x: 5, y: 3}, {note:"F", x: 4, y: 4}, {note:"A", x: 5, y: 1}, {note:"E", x: 5, y: 2}, {note:"C", x: 5, y: 3}, {note:"F", x: 4, y: 4}, {note:"A", x: 5, y: 1}, {note:"E", x: 5, y: 2}, {note:"C", x: 5, y: 3}, {note:"F", x: 4, y: 4}, {note:"B", x: 12, y: 2}, {note:"A", x: 10, y: 2}, {note:"G", x: 9, y: 2}, {note:"A", x: 10, y: 2}, {note:"B", x: 12, y: 2}, {note:"A", x: 10, y: 2}, {note:"G", x: 9, y: 2}, {note:"B", x: 12, y: 2}, {note:"A", x: 10, y: 2}, {note:"F", x: 10, y: 3}, {note:"D", x: 12, y: 4}, {note:"B", x: 9, y: 4}, {note:"F", x: 10, y: 3}, {note:"D", x: 10, y: 1}, {note:"C", x: 8, y: 1}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"G", x: 9, y: 2}, {note:"A", x: 10, y: 2}, {note:"G", x: 9, y: 2}, {note:"F", x: 10, y: 3}, {note:"D", x: 7, y: 3}, {note:"B", x: 9, y: 4}, {note:"G", x: 6, y: 4}, {note:"B", x: 9, y: 4}, {note:"D", x: 7, y: 3}, {note:"F", x: 10, y: 3}, {note:"E", x: 9, y: 3}, {note:"F", x: 10, y: 3}, {note:"E", x: 9, y: 3}, {note:"C", x: 10, y: 4}, {note:"B", x: 9, y: 4}, {note:"A", x: 7, y: 4}, {note:"A", x: 7, y: 4}, {note:"A", x: 10, y: 2}, {note:"B", x: 7, y: 1}, {note:"C", x: 8, y: 1}, {note:"D", x: 10, y: 1}, {note:"D", x: 10, y: 1}, {note:"D", x: 10, y: 1}, {note:"C", x: 8, y: 1}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"G", x: 9, y: 2}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"F", x: 10, y: 3}, {note:"E", x: 9, y: 3}, {note:"D", x: 7, y: 3}, {note:"C", x: 10, y: 4}, {note:"B", x: 9, y: 4}, {note:"E", x: 9, y: 3}, {note:"C", x: 10, y: 4}, {note:"A", x: 7, y: 4}, {note:"E", x: 7, y: 5}, {note:"A", x: 7, y: 4}, {note:"C", x: 5, y: 3}, {note:"E", x: 5, y: 2}, {note:"A", x: 5, y: 1}, {note:"B", x: 7, y: 1}, {note:"C", x: 8, y: 1}, {note:"A", x: 5, y: 1}, {note:"B", x: 7, y: 1}, {note:"F", x: 7, y: 2}, {note:"A", x: 10, y: 2}, {note:"G", x: 9, y: 2}, {note:"E", x: 9, y: 3}, {note:"D", x: 8, y: 3}, {note:"D", x: 7, y: 3}, {note:"C", x: 8, y: 1}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"G", x: 9, y: 2}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"E", x: 9, y: 3}, {note:"C", x: 10, y: 4}, {note:"A", x: 7, y: 4}, {note:"E", x: 12, y: 1}, {note:"E", x: 12, y: 1}, {note:"E", x: 12, y: 1}, {note:"B", x: 12, y: 2}, {note:"C", x: 13, y: 2}, {note:"E", x: 12, y: 1}, {note:"A", x: 14, y: 3}, {note:"C", x: 13, y: 2}, {note:"E", x: 12, y: 1}, {note:"A", x: 14, y: 3}, {note:"C", x: 13, y: 2}, {note:"E", x: 12, y: 1}, {note:"A", x: 14, y: 3}, {note:"C", x: 13, y: 2}, {note:"E", x: 12, y: 1}, {note:"F", x: 13, y: 1}, {note:"C", x: 9, y: 1}, {note:"E", x: 12, y: 1}, {note:"D", x: 10, y: 1}, {note:"A", x: 10, y: 2}, {note:"F", x: 10, y: 3}, {note:"D", x: 12, y: 4}, {note:"D", x: 12, y: 4}, {note:"A", x: 12, y: 5}, {note:"D", x: 12, y: 4}, {note:"F", x: 10, y: 3}, {note:"E", x: 12, y: 1}, {note:"D", x: 10, y: 1}, {note:"C", x: 8, y: 1}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"G", x: 9, y: 2}, {note:"B", x: 7, y: 1}, {note:"F", x: 10, y: 3}, {note:"D", x: 7, y: 3}, {note:"B", x: 9, y: 4}, {note:"A", x: 8, y: 4}, {note:"A", x: 7, y: 4}, {note:"G", x: 6, y: 4}, {note:"B", x: 9, y: 4}, {note:"D", x: 7, y: 3}, {note:"F", x: 10, y: 3}, {note:"E", x: 9, y: 3}, {note:"C", x: 10, y: 4}, {note:"A", x: 7, y: 4}, {note:"C", x: 10, y: 4}, {note:"A", x: 7, y: 4}, {note:"C", x: 10, y: 4}, {note:"E", x: 9, y: 3}, {note:"A", x: 10, y: 2}, {note:"C", x: 8, y: 1}, {note:"E", x: 12, y: 1}, {note:"G", x: 15, y: 1}, {note:"F", x: 13, y: 1}, {note:"B", x: 12, y: 2}, {note:"F", x: 13, y: 1}, {note:"A", x: 17, y: 1}, {note:"F", x: 13, y: 1}, {note:"D", x: 15, y: 2}, {note:"A", x: 14, y: 3}, {note:"F", x: 15, y: 4}, {note:"D", x: 12, y: 4}, {note:"E", x: 14, y: 4}, {note:"E", x: 12, y: 1}, {note:"E", x: 12, y: 1}, {note:"D", x: 11, y: 1}, {note:"D", x: 11, y: 1}, {note:"D", x: 10, y: 1}, {note:"D", x: 10, y: 1}, {note:"C", x: 9, y: 1}, {note:"C", x: 9, y: 1}, {note:"C", x: 8, y: 1}, {note:"C", x: 8, y: 1}, {note:"B", x: 7, y: 1}, {note:"B", x: 7, y: 1}, {note:"A", x: 5, y: 1}, {note:"A", x: 5, y: 1}, {note:"G", x: 4, y: 1}, {note:"G", x: 4, y: 1}, {note:"F", x: 6, y: 2}, {note:"F", x: 6, y: 2}, {note:"E", x: 5, y: 2}, {note:"D", x: 4, y: 2}, {note:"E", x: 5, y: 2}, {note:"A", x: 7, y: 4}, {note:"E", x: 9, y: 3}, {note:"D", x: 8, y: 3}, {note:"E", x: 9, y: 3}, {note:"E", x: 12, y: 1}, {note:"B", x: 7, y: 1}, {note:"D", x: 10, y: 1}, {note:"C", x: 8, y: 1}, {note:"G", x: 9, y: 2}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"E", x: 9, y: 3}, {note:"E", x: 5, y: 2}, {note:"F", x: 6, y: 2}, {note:"E", x: 5, y: 2}, {note:"D", x: 4, y: 2}, {note:"E", x: 5, y: 2}, {note:"F", x: 6, y: 2}, {note:"E", x: 5, y: 2}, {note:"F", x: 7, y: 2}, {note:"F", x: 6, y: 2}, {note:"B", x: 9, y: 4}, {note:"A", x: 7, y: 4}, {note:"A", x: 7, y: 4}, {note:"G", x: 6, y: 4}, {note:"B", x: 9, y: 4}, {note:"D", x: 7, y: 3}, {note:"D", x: 7, y: 3}, {note:"G", x: 6, y: 4}, {note:"B", x: 9, y: 4}, {note:"D", x: 7, y: 3}, {note:"F", x: 10, y: 3}, {note:"G", x: 9, y: 2}, {note:"B", x: 12, y: 2}, {note:"D", x: 10, y: 1}, {note:"F", x: 13, y: 1}, {note:"F", x: 14, y: 1}, {note:"B", x: 7, y: 1}, {note:"D", x: 10, y: 1}, {note:"C", x: 8, y: 1}, {note:"A", x: 10, y: 2}, {note:"C", x: 8, y: 1}, {note:"A", x: 10, y: 2}, {note:"E", x: 9, y: 3}, {note:"C", x: 10, y: 4}, {note:"E", x: 9, y: 3}, {note:"A", x: 10, y: 2}, {note:"C", x: 8, y: 1}, {note:"D", x: 10, y: 1}, {note:"B", x: 7, y: 1}, {note:"B", x: 7, y: 1}, {note:"C", x: 8, y: 1}, {note:"A", x: 10, y: 2}, {note:"B", x: 7, y: 1}, {note:"G", x: 9, y: 2}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"F", x: 10, y: 3}, {note:"D", x: 7, y: 3}, {note:"C", x: 10, y: 4}, {note:"B", x: 9, y: 4}, {note:"E", x: 9, y: 3}, {note:"E", x: 9, y: 3}, {note:"E", x: 9, y: 3}, {note:"C", x: 10, y: 4}, {note:"A", x: 7, y: 4}, {note:"E", x: 7, y: 5}, {note:"E", x: 7, y: 5}, {note:"A", x: 7, y: 4}, {note:"D", x: 6, y: 5}, {note:"E", x: 7, y: 5}, {note:"F", x: 8, y: 5}, {note:"E", x: 7, y: 5}, {note:"D", x: 6, y: 5}, {note:"E", x: 7, y: 5}, {note:"E", x: 7, y: 5}, {note:"E", x: 7, y: 5}, {note:"A", x: 7, y: 4}, {note:"E", x: 7, y: 5}, {note:"C", x: 3, y: 5}, {note:"A", x: 5, y: 6}, {note:"A", x: 5, y: 6}, {note:"C", x: 3, y: 5}, {note:"E", x: 7, y: 5}, {note:"A", x: 7, y: 4}, {note:"C", x: 8, y: 1}, {note:"G", x: 8, y: 2}, {note:"D", x: 8, y: 3}, {note:"A", x: 7, y: 4}, {note:"C", x: 8, y: 1}, {note:"G", x: 8, y: 2}, {note:"D", x: 8, y: 3}, {note:"A", x: 7, y: 4}, {note:"C", x: 8, y: 1}, {note:"G", x: 8, y: 2}, {note:"D", x: 8, y: 3}, {note:"A", x: 7, y: 4}, {note:"B", x: 7, y: 1}, {note:"F", x: 7, y: 2}, {note:"D", x: 7, y: 3}, {note:"G", x: 6, y: 4}, {note:"A", x: 5, y: 1}, {note:"E", x: 5, y: 2}, {note:"C", x: 5, y: 3}, {note:"F", x: 4, y: 4}, {note:"C", x: 8, y: 1}, {note:"G", x: 8, y: 2}, {note:"D", x: 8, y: 3}, {note:"A", x: 7, y: 4}, {note:"A", x: 5, y: 1}, {note:"E", x: 5, y: 2}, {note:"C", x: 5, y: 3}, {note:"F", x: 4, y: 4}, {note:"A", x: 5, y: 1}, {note:"E", x: 5, y: 2}, {note:"C", x: 5, y: 3}, {note:"F", x: 4, y: 4}, {note:"B", x: 7, y: 1}, {note:"F", x: 7, y: 2}, {note:"D", x: 7, y: 3}, {note:"G", x: 6, y: 4}, {note:"C", x: 8, y: 1}, {note:"G", x: 8, y: 2}, {note:"D", x: 8, y: 3}, {note:"A", x: 7, y: 4}, {note:"C", x: 9, y: 1}, {note:"G", x: 9, y: 2}, {note:"E", x: 9, y: 3}, {note:"A", x: 8, y: 4}, {note:"D", x: 10, y: 1}, {note:"A", x: 10, y: 2}, {note:"F", x: 10, y: 3}, {note:"B", x: 9, y: 4}, {note:"G", x: 15, y: 1}, {note:"D", x: 15, y: 2}, {note:"A", x: 15, y: 3}, {note:"E", x: 14, y: 4}, {note:"G", x: 3, y: 1}, {note:"D", x: 3, y: 2}, {note:"A", x: 3, y: 3}, {note:"E", x: 2, y: 4}, {note:"G", x: 3, y: 1}, {note:"F", x: 2, y: 1}, {note:"F", x: 1, y: 1}, {note:"E", x: 0, y: 1}, {note:"D", x: 4, y: 2}, {note:"D", x: 3, y: 2}, {note:"C", x: 2, y: 2}, {note:"C", x: 1, y: 2}, {note:"B", x: 0, y: 2}, {note:"A", x: 3, y: 3}, {note:"A", x: 2, y: 3}, {note:"G", x: 1, y: 3}, {note:"G", x: 0, y: 3}, {note:"F", x: 4, y: 4}, {note:"F", x: 3, y: 4}, {note:"E", x: 2, y: 4}, {note:"D", x: 1, y: 4}, {note:"D", x: 0, y: 4}, {note:"C", x: 4, y: 5}, {note:"E", x: 2, y: 4}, {note:"F", x: 3, y: 4}, {note:"G", x: 6, y: 4}, {note:"B", x: 4, y: 3}, {note:"D", x: 7, y: 3}, {note:"F", x: 6, y: 2}, {note:"G", x: 9, y: 2}, {note:"B", x: 7, y: 1}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"E", x: 9, y: 3}, {note:"C", x: 10, y: 4}, {note:"A", x: 7, y: 4}, {note:"C", x: 8, y: 1}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"G", x: 9, y: 2}, {note:"B", x: 7, y: 1}, {note:"A", x: 10, y: 2}, {note:"F", x: 10, y: 3}, {note:"D", x: 7, y: 3}, {note:"B", x: 4, y: 3}, {note:"F", x: 7, y: 2}, {note:"F", x: 6, y: 2}, {note:"E", x: 5, y: 2}, {note:"B", x: 4, y: 3}, {note:"C", x: 5, y: 3}, {note:"D", x: 7, y: 3}, {note:"C", x: 5, y: 3}, {note:"B", x: 4, y: 3}, {note:"C", x: 6, y: 3}, {note:"C", x: 5, y: 3}, {note:"A", x: 7, y: 4}, {note:"E", x: 7, y: 5}, {note:"E", x: 7, y: 5}, {note:"D", x: 8, y: 3}, {note:"D", x: 6, y: 5}, {note:"E", x: 9, y: 3}, {note:"E", x: 7, y: 5}, {note:"F", x: 10, y: 3}, {note:"F", x: 8, y: 5}, {note:"E", x: 9, y: 3}, {note:"E", x: 7, y: 5}, {note:"B", x: 7, y: 1}, {note:"B", x: 4, y: 3}, {note:"C", x: 8, y: 1}, {note:"C", x: 5, y: 3}, {note:"D", x: 10, y: 1}, {note:"D", x: 7, y: 3}, {note:"D", x: 11, y: 1}, {note:"D", x: 8, y: 3}, {note:"E", x: 12, y: 1}, {note:"E", x: 9, y: 3}, {note:"G", x: 9, y: 2}, {note:"G", x: 6, y: 4}, {note:"A", x: 10, y: 2}, {note:"A", x: 7, y: 4}, {note:"A", x: 10, y: 2}, {note:"A", x: 7, y: 4}, {note:"A", x: 10, y: 2}, {note:"A", x: 7, y: 4}, {note:"A", x: 7, y: 4}, {note:"C", x: 5, y: 3}, {note:"E", x: 5, y: 2}, {note:"A", x: 7, y: 4}, {note:"C", x: 5, y: 3}, {note:"E", x: 5, y: 2}, {note:"E", x: 5, y: 2}, {note:"E", x: 5, y: 2}, {note:"E", x: 5, y: 2}, {note:"D", x: 7, y: 3}, {note:"F", x: 6, y: 2}, {note:"A", x: 5, y: 1}, {note:"D", x: 7, y: 3}, {note:"F", x: 6, y: 2}, {note:"A", x: 5, y: 1}, {note:"A", x: 5, y: 1}, {note:"A", x: 5, y: 1}, {note:"A", x: 5, y: 1}, {note:"E", x: 9, y: 3}, {note:"G", x: 9, y: 2}, {note:"B", x: 7, y: 1}, {note:"E", x: 9, y: 3}, {note:"G", x: 9, y: 2}, {note:"B", x: 7, y: 1}, {note:"B", x: 7, y: 1}, {note:"C", x: 8, y: 1}, {note:"C", x: 8, y: 1}, {note:"A", x: 5, y: 1}, {note:"E", x: 5, y: 2}, {note:"C", x: 5, y: 3}, {note:"F", x: 4, y: 4 } 
		];


	// Counts number of notes
	notes.forEach( function(i) {
		notesMatrix[i.x][i.y-1]++;
	});
	var notesMax = d3.max(notesMatrix, function(d) { return d3.max(d); })

	// print fretboard values
	// for(var i=0; i<nfrets; i++) {
	// 	console.log(notesMatrix[i].join("\t"));
	// }


	///////////////////////
	// GLOBAL PARAMETERS //
	///////////////////////

	var palettes = [
		[ // Ocean Five
			"#00A0B0",
			"#6A4A3C",
			"#CC333F",
			"#EB6841",
			"#EDC951"
		],
		[ // Giant Goldfish
			"#69D2E7",
			"#A7DBD8",
			"#E0E4CC",
			"#F38630",
			"#FA6900",
			
		],
		[ // let them eat cake
			"#774F38",
			"#E08E79",
			"#F1D4AF",
			"#ECE5CE",
			"#C5E0DC",
		]
	];

	var CURVECOLOR = "#00A0B0";
	var NOTESCOLOR = "#CC333F";
	var NOTESSIZE = "9";
	var LINESWIDTH = "2";

	var notesAlpha = 0.1;
	var linesAlpha = 0.1;



	//////////////////////
	// Initializations  //
	//////////////////////


	var svg = d3.select("#d3container")
		.append("svg")
		.attr("width", 1857) // dimensions of the fret image
		.attr("height", 118);

	svg.append("svg:image")
		.attr('id',"image")
		.attr('width', "100%")
		.attr('height', "100%")
		.attr("xlink:href","neck.jpg")
		// .attr('opacity', '0');


	/////////////////////////////
	// Control panel settings  //
	/////////////////////////////

	function updateAttrConfig(controlName, elemName, newValue) {
	  d3.select("#"+controlName).property("value", newValue);
	  svg.selectAll("circle").attr(elemName, newValue);
	}

	function updateStyleConfig(controlName, elemName, newValue) {
		d3.select("#"+controlName).property("value", newValue);
		svg.selectAll(elemName).style("opacity", newValue/100);
	}

	d3.select("#data_radius").on("input", function() {
		updateAttrConfig("data_radius","r",+this.value);
	});

	d3.select("#notesAlpha").on("input", function() {
		updateStyleConfig("notesAlpha", "circle", this.value);
	});

	d3.select("#linesAlpha").on("input", function() {
		updateStyleConfig("linesAlpha", "path", this.value);
	});

	// FIX ME!
	d3.select("#showImage").on("input", function() {
		console.log(this.value);
		// svg.selectAll(image).attr("hidden", this.value);
	});

	updateAttrConfig("data_radius","r",NOTESSIZE);
	updateStyleConfig("notesAlpha", "g", notesAlpha*100);
	updateStyleConfig("linesAlpha", "path", linesAlpha*100);


	////////////////////////////////////////////////////////////////////////////
	



	// // Pair-wise lines
	// svg.selectAll(".line")
	//    .data(d3.pairs(notes))
	//    .enter()
	//    .append("line")
	//    .attr("x1", function(d) { return fretCoords[d[0].x] })
	//    .attr("y1", function(d) { return stringCoords[d[0].y] })
	//    .attr("x2", function(d) { return fretCoords[d[1].x] })
	//    .attr("y2", function(d) { return stringCoords[d[1].y] })
	//    .style("stroke", CURVECOLOR)
	//    .style("stroke-width", 1)
	//    .style("opacity", linesAlpha);

	svg.selectAll(".line")
		.data(d3.pairs(notes))
		.enter()
		.append("path")
		// Crazy function that creates a cool slightly bended curve
		.attr("d", function(d) {
			var sx = fretCoords[d[0].x], sy = stringCoords[d[0].y-1],
			tx = fretCoords[d[1].x], ty = stringCoords[d[1].y-1],
			dx = tx - sx, dy = ty - sy,
			dr = 2 * Math.sqrt(dx * dx + dy * dy);
			return "M" + sx + "," + sy + "A" + dr + "," + dr + " 0 0,1 " + tx + "," + ty;
		  })
		.style("stroke", CURVECOLOR)
		.style("fill", "none")
		.style("stroke-width", LINESWIDTH)
	   	.style("opacity", linesAlpha);

	// Notes
	var scaler = d3.scale.linear()
	    .domain([0, notesMax])
	    .range([0.2, 1]);


	for (var i = 0; i < nfrets; i++) {
		var p = svg.selectAll("g.n"+i)
			.data(notesMatrix[i]);
		
		var g = p.enter()
			.append("g")
				.attr("transform", function(d,j) { return "translate(" + fretCoords[i] + "," + stringCoords[j] + ")"; } )
				.attr("opacity", function(d) { return scaler(d); });

		g.append("svg:circle")
				// .attr("cx", fretCoords[i] )
				// .attr("cy", function(d,j) { return stringCoords[j]; })
				// .attr("opacity", function(d) { return scaler(d); })
				.attr("r", NOTESSIZE)
				// .attr("width", NOTESSIZE+"px")
				// .attr("height", NOTESSIZE+"px")
				.attr("fill", NOTESCOLOR);
				// .on("mouseover", function(){d3.select(this).transition().style("fill", "aliceblue");})
				// .on("mouseout", function(){d3.select(this).transition().style("fill", "lightblue");});

		g.append("text")
				.text(function(d,j) { return notesMap[j][i]; })
				// .attr("x", fretCoords[i] )
				// .attr("y", function(d,j) { return stringCoords[j]; })
			    // .attr("opacity", function(d) { return scaler(d); })
			    .style("font-family", "sans-serif")
				.style("font-size", "11px")
				.style("text-anchor", "middle")
				.style("dominant-baseline", "central")
				.style("pointer-events", "none")
				.style("fill","white");

		p.exit().remove();
	};

	// svg.selectAll("circle.notes")
	// 	.data(notes)
	// 	.enter()
	// 	.append("text")
	// 	.text("X")
	// 	.style("font-family", "sans-serif")
	//    .style("font-size", "11px")
	//    .style("text-anchor", "middle")
	//    .style("dominant-baseline", "central")
	//    .style("stroke", "white")
	//    .style("pointer-events", "none");

	// // Single, interpolated line
	// var lineFunction = d3.svg.line()
	// 	.x(function(d) { return fretCoords[d.x]; })
	// 	.y(function(d) { return stringCoords[d.y]; })
	// 	.tension(0.9)
	// 	.interpolate("cardinal");
	// var lineGraph = svg.append("path")  
	// 	.attr("d", lineFunction(notes))
	// 	.attr("stroke", CURVECOLOR)
	// 	.attr("stroke-width", 1)
	// 	.attr("opacity", 0.5)
	// 	.attr("fill", "none");

	</script>
</body>

</html>